# GuardAsync

GuardAsync is a primitive designed to encapsulate a promise that resolves to a value of type T. It provides methods to handle scenarios where the resolved value may be undefined, offering mechanisms to retrieve a default value or throw an error if the value is undefined.

## Usage Consideration

GuardAsync is intended for scenarios where asynchronous retrieval of a value is necessary, and handling of undefined values is critical. It ensures robust error handling and provides flexibility in managing fallback values or enforcing strict value presence checks.

## Constructor

### `constructor(valuePromise: Promise<T>)`

- **Parameters:**
  - `valuePromise`: A promise that resolves to a value of type `T`.
- **Description:**
  - Initializes an instance of GuardAsync with the provided promise that resolves to a value of type T.

## Methods

### `or(defaultValue: T): Promise<T>`

- **Parameters:**
  - `defaultValue`: The value to return if the guarded value is undefined.
- **Returns:**
  - `Promise<T>`: A promise that resolves to the guarded value if it is defined, or `defaultValue` if it is undefined.
- **Description:**
  - Returns a promise that resolves to the guarded value if it is not undefined. If the guarded value is undefined, resolves to the provided `defaultValue`.

### `_throws(): Promise<T>`

- **Throws:**
  - `Error`: If the guarded value is undefined.
- **Returns:**
  - `Promise<T>`: A promise that resolves to the guarded value if it is defined.
- **Description:**
  - Returns a promise that resolves to the guarded value if it is not undefined. If the guarded value is undefined, throws an error indicating that the value is undefined.

## Example Usage

```ts
import { GuardAsync } from "koka-ts";

// Example function that retrieves a user's profile asynchronously
async function getUserProfile(userId: string): Promise<string> {
  // Simulate fetching user profile data
  return new Promise<string>((resolve, reject) => {
    setTimeout(() => {
      const userProfile = userId === "123" ? "User Profile Data" : undefined;
      resolve(userProfile);
    }, 1000);
  });
}

// Usage of the GuardAsync primitive
async function displayUserProfile(userId: string) {
  const profilePromise = getUserProfile(userId);
  const guard = new GuardAsync<string>(profilePromise);

  try {
    const userProfile = await guard._throws();
    console.log("User Profile:", userProfile);
  } catch (error) {
    console.error("Error retrieving user profile:", error.message);
  }
}

// Call the function
const userId = "123";
displayUserProfile(userId);
